@import play.api.data.Form
@import forms.AliasChangeForm
@import models.User

@(aliasForm: Form[AliasChangeForm], user: User)(implicit request: RequestHeader, flash: Flash, messages: Messages)

@main(messages("alias.title"), Some(user)) {
    <article>
        <header>
            <h1>@messages("alias.title")</h1>
            <p>@messages("alias.subtitle")</p>
        </header>

        @if(flash.get("success").isDefined) {
            <div role="alert" class="success">
                @flash.get("success")
            </div>
        }

        @if(flash.get("error").isDefined) {
            <div role="alert" class="error">
                @flash.get("error")
            </div>
        }

        <div class="current-alias">
            <p><strong>@messages("alias.current")</strong> @user.userName</p>
        </div>

        @helper.form(action = routes.AliasController.changeAlias()) {
            @helper.CSRF.formField
            
            <fieldset>
                <label for="newAlias">
                    @messages("alias.new.label")
                    <input type="text" 
                           id="newAlias" 
                           name="newAlias" 
                           value="@aliasForm("newAlias").value.getOrElse("")" 
                           placeholder="@messages("alias.new.placeholder")"
                           @if(aliasForm("newAlias").hasErrors) {aria-invalid="true"}
                           required>
                    @if(aliasForm("newAlias").hasErrors) {
                        <small class="error">@aliasForm("newAlias").errors.map(_.message).mkString(", ")</small>
                    } else {
                        <small>@messages("alias.new.help")</small>
                    }
                </label>
            </fieldset>

            <div class="action-buttons">
                <button type="submit" class="primary">@messages("alias.update.button")</button>
                <a href="@routes.HomeController.index()" role="button" class="secondary">@messages("alias.cancel.button")</a>
            </div>
        }

        <footer>
            <small>
                <strong>@messages("status.info"):</strong> @messages("alias.note")
            </small>
        </footer>
    </article>
}
