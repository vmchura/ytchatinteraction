@import models.UserMatchInfo
@import models.viewmodels.{MatchDisplayData, MatchStatus}

@(userMatches: List[UserMatchInfo])(implicit request: RequestHeader, messages: Messages)

@if(userMatches.nonEmpty) {
<section>
    <h2>@messages("partials.matches.title")</h2>
    <p>@messages("partials.matches.description")</p>

    <div>
        <table>
            <thead>
            <tr>
                <th>@messages("partials.matches.tournament")</th>
                <th>@messages("partials.matches.opponent")</th>
                <th>@messages("partials.matches.status")</th>
                <th>@messages("partials.matches.scheduled.time")</th>
                <th>@messages("partials.matches.result")</th>
                <th>@messages("partials.matches.actions")</th>
            </tr>
            </thead>
            <tbody>
            @for(matchInfo <- userMatches) {
            @defining(MatchDisplayData.fromUserMatchInfo(matchInfo)) { matchData =>
            <tr>
                <td>@matchData.tournamentName</td>
                <td>@matchData.opponent</td>
                <td>@renderMatchStatus(matchData.status)</td>
                <td>@matchData.scheduledTime.getOrElse(messages("partials.matches.not.scheduled"))</td>
                <td>
                    @if(matchData.hasResult) {
                    <span>@messages("partials.matches.see.result")</span>
                    } else {
                    <span>@messages("partials.matches.pending")</span>
                    }
                </td>
                <td>
                    @if(matchData.canUploadReplay) {
                    <a href="@routes.FileUploadController.uploadFormForMatch(matchData.tournamentID, matchData.challengeMatchId)"
                       role="button" class="outline">
                        @messages("partials.matches.upload.replay")
                    </a>
                    }
                </td>
            </tr>
            }
            }
            </tbody>
        </table>
    </div>
</section>
}

@renderMatchStatus(status: MatchStatus) = {
@status match {
case MatchStatus.Open => {
<mark>@status.displayName</mark> }
case MatchStatus.Pending => {
<mark>@status.displayName</mark> }
case MatchStatus.Complete => {
<mark>@status.displayName</mark> }
case MatchStatus.Other(_) => {
<mark>@status.displayName</mark> }
}
}
